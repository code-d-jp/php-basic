# while文

配列構造の1つである`while`文を見ていきましょう。次のプログラムは1〜3まで出力するものです。次のプログラム（loop1.php）を作成してみましょう。

```php
<?php
$i = 1;
while ($i < 4) {
  echo $i . PHP_EOL;
  $i++;
}
```

まずは作成したプログラムを実行してみましょう。ターミナルから次のように実行します。

```
$ php loop1.php
1
2
3
```


## while文

`while`文は反復構造を定義する構文です。

```php
while (条件式) {
  // 条件が成立した場合に実行する処理
}
```

上記のように`()`の中に条件式を記述し、`{}`の中に条件が成立した場合に実行する処理を記述します。

さきほどのプログラム(loop1.php)の場合、条件式`$i < 4`となっています。これは「変数`$i`が`4`より小さい」という条件を定義しています。変数$iの初期値は1を代入しているので、繰り返しの初回は条件が成立することになります。

> 条件式には値の大小を比較する`>`や`<`といった比較演算子を使うことが多いです。

条件式が成立した場合`{}`の中に記述した処理が実行されます。さきほどのプログラム(loop1.php)の場合、以下のように記述しています。

```php
while ($i < 4) {
  echo $i . PHP_EOL;
  $i++;
}
```

`{}`の中ではまず`echo $i . PHP_EOL;`が実行されるので、変数$iの内容が改行コード（`PHP_EOL`）とともに出力されます。続いて`$i++;`が実行されるので変数$iのデータがインクリメント（1増加）されます。`$i++;`の処理を終えると`while`文の処理ブロックの終端である`}`に到達します。`}`に到達すると処理は、再び、条件式の比較（`$i < 4`）に戻ります。この時点で変数`$i`は`2`となっていますが、条件式`$i < 4`は成立するので再度、`{}`の中の処理を実行することになります。

|$i|$i < 3|反復処理|
|:--|:--|:--|
|1|true|1を出力する<br>$iをインクリメントする|
|2|true|2出力する<br>$iをインクリメントする|
|3|true|3出力する<br>$iをインクリメントする|
|4|false|反復処理を終了する|
{.table}

## 配列と反復構造

`while`文などの反復構造は配列と相性の良い仕組みです。たとえば前章で学習したプログラム（array1.php）を見てみましょう。

```php
<?php
$names = ["Andy", "Betty", "Carol"];

echo "Hello ";
echo $names[0];
echo "Hello ";
echo $names[1];
echo "Hello ";
echo $names[2];
```

このプログラムは配列$namesに`Andy`、`Betty`、`Carol`という3人の名前が代入されています。3人の名前を出力するために同じような記述（echo命令）を3回記述しているのがわかります。反復構造を利用すれば次のように実装できます(loop2.php)。

```php
<?php
$names = ["Andy", "Betty", "Carol"];

$i = 0;
while ($i < 3) {
    echo "Hello ";
    echo $names[$i] . PHP_EOL;
    $i++;
}
```

配列の要素番号の指定に変数`$i`を利用しているのがポイントです。変数`$i`は初期値に`0`が代入されており、条件式は`$i < 3`はとなっています。また反復処理`{}`の中では変数`$i`がインクリメントされているので、変数`$i`は`0`、`1`、`2`と順に処理されていくことになります。

プログラムを実行してみましょう。

```
$ php loop2.php
Hello Andy
Hello Betty
Hello Carol
```

配列の要素が順に出力されているのがわかります。


## 反復条件の指定

反復条件の指定には比較演算子を使うことが多いです。いくつかサンプルを見てみましょう。次のプログラム（loop3.php）を作成します。

```php
<?php
$i = 1;
while ($i <= 1) {
  echo $i . PHP_EOL;
  $i++;
}
```

条件式`$i <= 1`は、変数`$i`が`1`以下の場合を意味します。プログラムを実行すると次のように出力されます。

```
$ php loop3.php
1
```

それでは次のプログラムはどうでしょうか。さきほどのプログラム（loop3.php）の条件式を次のように修正してみましょう。


```php
<?php
$i = 1;
while ($i > 5) {
  echo $i . PHP_EOL;
  $i++;
}
```

条件式`$i > 5`は、変数`$i`が`5`より大きい場合を意味します。変数`$i`の初期値は`1`ですので実行すると次のようになります。

```
$ php loop3.php
```

反復処理が一度も実行されないので、上記のように何も出力されないようになります。

もう一つプログラムを見てみましょう。さきほどのプログラム（loop3.php）の条件式を次のように修正してみましょう。

```php
<?php
$i = 1;
while (true) {
  echo $i . PHP_EOL;
  $i++;
}
```

ここでは条件式に`true`を指定しています。少し違和感があるかもしれませんが、これも文法としては成立しています。これまで条件式に`<`や`<=`といった比較演算子を使う例を示してきましたが、比較演算子の評価結果は必ず論理型データ（true / false）になります。つまりwhile文の条件式の正体は論理型データです。

さきほどのプログラム（loop3.php）を実行すると次のような実行結果となります。

```
$ php loop3.php
1
2
3
...無限に繰り返す
```

> ターミナルでcrrlキーとcキーを同時に押すとプログラムは停止します。

反復構造では条件式の作り方次第で、今回のようにプログラムが無限にループしてしまうこともあります。
